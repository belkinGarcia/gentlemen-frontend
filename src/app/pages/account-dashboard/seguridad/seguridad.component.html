<div class="seguridad-container">
  <h2>Seguridad</h2>
  <p>Actualiza tu contraseña de acceso.</p>
  <form [formGroup]="passwordForm" (ngSubmit)="updatePassword()" class="password-form">
    <mat-form-field appearance="fill">
      <mat-label>Contraseña Actual</mat-label>
      <input matInput formControlName="currentPassword" [type]="hideCurrent ? 'password' : 'text'">
      <button mat-icon-button matSuffix (click)="hideCurrent = !hideCurrent" type="button">
        <mat-icon>{{hideCurrent ? 'visibility_off' : 'visibility'}}</mat-icon>
      </button>
      <mat-error *ngIf="passwordForm.get('currentPassword')?.hasError('required')">
        La contraseña actual es requerida.
      </mat-error>
    </mat-form-field>
    <mat-form-field appearance="fill">
      <mat-label>Nueva Contraseña</mat-label>
      <input matInput formControlName="newPassword" [type]="hideNew ? 'password' : 'text'">
      <button mat-icon-button matSuffix (click)="hideNew = !hideNew" type="button">
        <mat-icon>{{hideNew ? 'visibility_off' : 'visibility'}}</mat-icon>
      </button>
      <mat-hint>Debe tener al menos 8 caracteres.</mat-hint>
      <mat-error *ngIf="passwordForm.get('newPassword')?.hasError('required')">
        La nueva contraseña es requerida.
      </mat-error>
      <mat-error *ngIf="passwordForm.get('newPassword')?.hasError('minlength')">
        Mínimo 8 caracteres.
      </mat-error>
    </mat-form-field>
    <mat-form-field appearance="fill">
      <mat-label>Confirmar Contraseña</mat-label>
      <input matInput formControlName="confirmPassword" [type]="hideConfirm ? 'password' : 'text'">
      <button mat-icon-button matSuffix (click)="hideConfirm = !hideConfirm" type="button">
        <mat-icon>{{hideConfirm ? 'visibility_off' : 'visibility'}}</mat-icon>
      </button>
      <mat-error *ngIf="confirmPasswordControl?.hasError('required')">
        Confirma tu nueva contraseña.
      </mat-error>
      <mat-error *ngIf="passwordMismatchError">
        Las contraseñas no coinciden.
      </mat-error>
    </mat-form-field>
    <div *ngIf="successMessage" class="alert alert-success">
      {{ successMessage }}
    </div>
    <div *ngIf="errorMessage" class="alert alert-error">
      {{ errorMessage }}
    </div>
    <button mat-flat-button color="primary" type="submit" [disabled]="passwordForm.invalid">
      Actualizar Contraseña
    </button>
  </form>
</div>