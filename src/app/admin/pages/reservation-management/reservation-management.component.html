<div class="reservation-management-container">
  <h2>Gesti√≥n de Citas</h2>
  <p>Visualiza y administra todas las citas programadas en la plataforma.</p>

  <table mat-table [dataSource]="dataSource" class="mat-elevation-z2">

    <ng-container matColumnDef="status">
      <th mat-header-cell *matHeaderCellDef> Estado </th>
      <td mat-cell *matCellDef="let res">
        <mat-chip [color]="getStatusColor(res.status)" selected>
          {{ res.status | titlecase }}
        </mat-chip>
      </td>
    </ng-container>

    <ng-container matColumnDef="dateTime">
      <th mat-header-cell *matHeaderCellDef> Fecha y Hora </th>
      <td mat-cell *matCellDef="let res">
        <strong>{{ res.date | date:'mediumDate' }}</strong>
        <span class="sub-text">{{ res.time }}</span>
      </td>
    </ng-container>

    <ng-container matColumnDef="client">
      <th mat-header-cell *matHeaderCellDef> Cliente </th>
      <td mat-cell *matCellDef="let res">
        <strong>{{ res.user.firstName }} {{ res.user.lastName }}</strong>
        <span class="sub-text">{{ res.user.email }}</span>
      </td>
    </ng-container>

    <ng-container matColumnDef="service">
      <th mat-header-cell *matHeaderCellDef> Servicio </th>
      <td mat-cell *matCellDef="let res"> {{ res.service?.name }} </td>
    </ng-container>

    <ng-container matColumnDef="barber">
      <th mat-header-cell *matHeaderCellDef> Barbero </th>
      <td mat-cell *matCellDef="let res"> {{ res.barber?.name }} </td>
    </ng-container>

    <ng-container matColumnDef="location">
      <th mat-header-cell *matHeaderCellDef> Local </th>
      <td mat-cell *matCellDef="let res"> {{ res.location?.name }} </td>
    </ng-container>

    <ng-container matColumnDef="actions">
      <th mat-header-cell *matHeaderCellDef></th>
      <td mat-cell *matCellDef="let res">
        <button 
          mat-icon-button 
          color="warn" 
          *ngIf="res.status === 'upcoming'"
          (click)="cancelReservation(res)"
          matTooltip="Cancelar cita">
          <mat-icon>cancel</mat-icon>
        </button>
      </td>
    </ng-container>

    <tr mat-header-row *matHeaderRowDef="displayedColumns"></tr>
    <tr mat-row *matRowDef="let row; columns: displayedColumns;"></tr>
  </table>
</div>